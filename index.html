<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <div ng-app="skyDogs" id="app-container" class="loading full-size">
            <div id="loading-message" class="full-size"><span>Loading <span id="loading-message-type">Libraries</span></span></div>
            <div class="full-size">
                <div id="map-canvas" class="full-size" />
                <div id="top-menu">
                    <div id="worldMarketBtn" class="menuBtn">World Market</div>
                </div>
                <div ng-controller="CityUIController" id="cityScreen" class="full-size" city_id="{{city.id}}">
                    <div id="cityScreen-container" class="center-xy">
                        <div id="cityScreenLeft">
                            <div id="cityScreen-country" style="{{country.css}}">
                                <img id="cityScreen-country-flag" ng-src="{{getFlagUrl(country.flag_file)}}">
                                <div id="cityScreen-country-name">{{country.name}}</div>
                            </div>
                            <div id="cityScreen-marketBtn" class="cityScreen-btn" ng-click="openCityMarket()">
                                Market
                                <div id="cityScreen-sellAllBtn" class="cityScreen-btn cityScreen-subBtn">Sell All</div>
                            </div>
                            <div id="cityScreen-hangarBtn" class="cityScreen-btn">
                                Hangar
                                <div id="cityScreen-refuelBtn" class="cityScreen-btn cityScreen-subBtn">Refuel</div>
                            </div>
                            <div id="cityScreen-cityhallBtn" class="cityScreen-btn" disabled="true">City Hall</div>
                            <div id="cityScreen-speakeasyBtn" class="cityScreen-btn" disabled="true">Speakeasy</div>
                            <div id="cityScreen-leaveBtn" class="cityScreen-btn">Leave city</div>
                        </div>
                        <div id="cityScreenRight">
                            <div id="cityScreen-name">{{city.name}}</div>
                            <div id="cityScreen-pop">Pop. {{city.population.city}}</div>
                            <div id="cityScreen-content" class="scrollable">
                                <div id="cityMarket" class="cityScreen-contentItem" ng-hide="!market.isActive">
                                    <h1>Market</h1>
                                    <table id="cityScreenMarket" class="tablesorter">
                                        <thead>
                                            <tr>
                                                <td class="borderRight" colspan="2">Commodity</td>
                                                <td class="borderRight" colspan="3">City</td><td colspan="2">You</td>
                                            </tr>
                                            <tr>
                                                <th>Name</th>
                                                <th class="borderRight">Avg.</th>
                                                <th>Buys for</th>
                                                <th>Sells for</th>
                                                <th class="borderRight">Stock</th>
                                                <th>Value</th>
                                                <th>Amount</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="co in market.commodities.getAll()" co_id="{{co.id}}">
                                                <td>{{co.name}}</td>
                                                <td class="borderRight">{{co.basePrice}}</td>
                                                <td style="{{co.sellCss}}" ng-disabled="co.sellDisabled" ng-click="openMarketShop(co.id)">{{co.buyPrice}}</td>
                                                <td style="{{co.buyCss}}"  ng-disabled="co.buyDisabled"  ng-click="openMarketShop(co.id)">{{co.salePrice}}</td>
                                                <td class="borderRight">{{co.cityAmount}}</td>
                                                <td>{{co.playerValue}}</td>
                                                <td>{{co.playerAmount}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div id="cityMarketShop" class="window center-xy" ng-hide="!market.shop.isActive">
                                    <div class="windowHeader">
                                        <select id="shopTypeSelector">
                                            <option selected="{{market.shop.buySelected}}" value="buy">Buy</option>
                                            <option selected="{{market.shop.sellSelected}}" value="sell">Sell</option>
                                        </select>
                                        <select id="shopCommoditySelector">
                                            <option ng-repeat="co in market.commodities.getAll()" selected="{{co.selected}}" value="{{co.id}}">{{co.name}}</option>
                                        </select>
                                        <span class="windowClose" action="cancel">x</span>
                                    </div>
                                    <div class="windowContent scrollable">
                                        <table id="shopContent">
                                            <tr>
                                                <td>Amount:</td>
                                                <td><input type=number id="shopAmount" value="1" min="1"></td>
                                                <td class="gray">({maket.shop.amountAvailable}} available)</td>
                                            </tr>
                                            <tr>
                                                <td>Unit Price:</td>
                                                <td>{{market.shop.commodityPrice}}</td>
                                            </tr>
                                            <tr>
                                                <td>Unit Weight:</td>
                                                <td>{{market.shop.commodityWeight}} kg</td>
                                            </tr>
                                            <tr class="sum-row">
                                                <td>Total Sum:</td>
                                                <td>{{market.shop.priceSum}}</td>
                                                <td rowspan="4"><span id="shopConfirm" class="windowButton" action="confirm"></span></td>
                                            </tr>
                                            <tr class="gray">
                                                <td>Your money:</td>
                                                <td>{{getMoney(player.money, true)}}</td>
                                            </tr>
                                            <tr>
                                                <td>Total Weight:</td>
                                                <td>{{market.shop.weightSum}} kg</td>
                                            </tr>
                                            <tr class="gray">
                                                <td>Free space:</td>
                                                <td>{{aircraft.getFreeCargoSpace()}} kg</td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="windowFooter"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="notifications"></div>
            </div>
        </div>
        <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
        <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.22.0/mapbox-gl.js'></script>
        <script src='lib/turf.min.js'></script>
        <script src='lib/jquery.tablesorter.min.js'></script>
        <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.22.0/mapbox-gl.css' rel='stylesheet' />
        <link href='lib/font-awesome-4.6.3/css/font-awesome.min.css' rel='stylesheet' />
        <script src="scripts/common.js"></script>
        <script src="scripts/objects.js"></script>
        <script>$('#loading-message').css('opacity', 0.5);</script>
        
        <script>$('#loading-message-type').text('Fake Server');</script>
        <script src="scripts/fakeDB.js"></script>
        <script src="scripts/fakeNodeServer.js"></script>
        
        <script>$('#loading-message-type').text('Map');</script>
        <script src="scripts/createMap.js"></script>
        
        <script>$('#loading-message-type').text('Script');</script>
        <script src="scripts/gameScript.js"></script>
        <script src="scripts/drawScreen.js"></script>
        <script src="scripts/UI.js"></script>
        <script src="scripts/UI-city.js"></script>
        <script src="scripts/UI-game.js"></script>
        
        <script>
            $('#loading-message-type').text('ready!');
            
            // as the last act, remove the loading status
            $('#loading-message').fadeOut();
            $('#app-container.loading').removeClass('loading');
        </script>

    </body>
</html>
